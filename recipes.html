<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Spoonful - Recipes</title>
        <!-- Google Fonts -->
        <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500&family=Lato:wght@400;500&display=swap" rel="stylesheet">
        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    </head>

    <body>
        <!-- Slogan lol -->
            <div class="mt-0" rounded text-center" style="background-color:#dbeef4"> 
                <h6 class="text-center" style="font-family:'Quicksand'; color:#688c96;"> 
                    a taste of love, in every recipe  
                </h6>
            </div>

            <!-- NavBar -->
                <nav class="navbar navbar-expand-lg bg-body-tertiary; style="background-color: #ffffff; padding: 10px 20px;">
                    <div class="container-fluid">
                        <a class="navbar-brand" href="https://jenniferguinanzaca.github.io/final/index.html" style="font-family:'Quicksand'; color:#688c96; font-size:34px;"> Spoonful</a>

                <!--Collapse 4 mobile-->
                        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>

                        <div class="collapse navbar-collapse justify-content-end" id="navbarContent">
                            <ul class="navbar-nav mb-2 mb-lg-0">
                                <li class="nav-item">
                                    <a class="nav-link active" aria-current="page" href="https://jenniferguinanzaca.github.io/final/index.html" style="color:#688c96;">Home</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#AboutUs" style="color:#688c96;">About Us</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#" style="color:#688c96;" >Recipes</a>
                                </li>
                            </ul>
                            <form class="d-flex ms-3" role="search">
                            <input id="searchInput" class="form-control rounded-pill border border-secondary me-2 px-3" 
                            type="search" 
                            placeholder="Search recipes..." 
                            aria-label="Search" style="width: 200px; transition: all 0.3s;">
                            <button type= "button" class="btn btn-outline-success rounded-pill px-4" 
                            type="submit" onclick="searchRecipe()">Search</button>
                        </form>
                    </div>
                </div>
            </nav>

            <hr style="border: none; height: 1px; background-color: #d5d2d1; margin: 0 0 20px 0;"> 

            <!--Recipess-->
            <section class="container py-5">
                 <h2 id="pageTitle" class="text-center mb-4" style="font-family:'Quicksand'; color:#688c96;">Recipes</h2>
                  <div id="recipes_Container" class="row justify-content-center g-4">
                    <!-- cards will go here--> 
                 </div>
            </section>

    </body>

    <script>
        const apiKey = "fa5eca3f2d24416287a3dc418835e215";
        const container = document.getElementById("recipes_Container");

        //FUNCTION LOADS RECIPE BASED ON category , query , or all!!!
        async function loadRecipes(){

            try{
                const params = new URLSearchParams(window.location.search);
                const category = params.get("category");
                const query = params.get("query");
                const showAll = params.get("all");

                let url = `https://api.spoonacular.com/recipes/complexSearch?apiKey=${apiKey}&addRecipeInformation=true`;
                if (category){
                    url += `&cuisine=${category}`;
                    url +=`&number=5`;
                } else if (query){
                    url += `&query=${query}`;
                    url+=`&number=5`;
                } else if (showAll){
                    url += `&number=10`;
                //} else {
                //    url += `&number=5`;
                }
                
                const response = await fetch(url);
                const data = await response.json();
                const recipes = data.results;
                displayRecipes(recipes);
            } catch (error) {
                container.innerHTML = "<p> Could not load recipes. Try again later. </p>";
                console.error("Error loading recipes:",error);
            }
        }

        function searchRecipe(){
            const query = document.getElementById("searchInput").value.trim();
            if (query){
                window.location.href = `recipes.html?query=${encodeURIComponent(query)}`;
            }
        }

        function displayRecipes(recipes) {
                        container.innerHTML = "";
                        recipes.forEach(recipe => {
                        container.innerHTML += `
                        <div class="col-12 col-sm-6 col-md-3">
                            <a href="recipe.html?id=${recipe.id}" class="text-decoration-none">
                            <div class="card shadow-sm border-0 h-100">
                                <img src="${recipe.image}" class="card-img-top" alt="${recipe.title}">
                                <div class="card-body text-center">
                                        <h5 style="color:#688c96;">${recipe.title}</h5>
                                        <p style="font-size:14px; color:#555;">Total time: ${recipe.readyInMinutes} mins</p>
                                </div>
                            </div>
                        </a>
                    </div>`;
                });
            }
        loadRecipes();
    </script>
</html>
